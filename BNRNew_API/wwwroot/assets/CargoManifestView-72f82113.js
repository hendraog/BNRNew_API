import{_ as W,i as y,g as X,u as Y,a as ee,r as h,o as ae,j as N,k as _,c as x,l as i,m as P,F as te,n as le,f as M,b as r,t as oe,s as ne,p as S,q as V,x as se,y as ie,z as re}from"./index-71bc4530.js";import{S as ue}from"./index-20f92749.js";const b=k=>(ie("data-v-b34e0732"),k=k(),re(),k),ce={class:"flex flex-row w-full"},de={class:"flex flex-col",style:{width:"30%"}},ge=b(()=>r("div",{class:"h-20"},null,-1)),pe=b(()=>r("div",{class:"p-2"},[r("div",{class:"bg-white h-full",style:{width:"1px"}})],-1)),me={class:"flex-1 flex flex-col"},he={class:"mr-2 mb-2 block text-sm font-medium text-white"},_e=["onClick"],ve=b(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"mr-2 w-5 h-5"},[r("path",{"fill-rule":"evenodd",d:"M5 2.75C5 1.784 5.784 1 6.75 1h6.5c.966 0 1.75.784 1.75 1.75v3.552c.377.046.752.097 1.126.153A2.212 2.212 0 0 1 18 8.653v4.097A2.25 2.25 0 0 1 15.75 15h-.241l.305 1.984A1.75 1.75 0 0 1 14.084 19H5.915a1.75 1.75 0 0 1-1.73-2.016L4.492 15H4.25A2.25 2.25 0 0 1 2 12.75V8.653c0-1.082.775-2.034 1.874-2.198.374-.056.75-.107 1.127-.153L5 6.25v-3.5Zm8.5 3.397a41.533 41.533 0 0 0-7 0V2.75a.25.25 0 0 1 .25-.25h6.5a.25.25 0 0 1 .25.25v3.397ZM6.608 12.5a.25.25 0 0 0-.247.212l-.693 4.5a.25.25 0 0 0 .247.288h8.17a.25.25 0 0 0 .246-.288l-.692-4.5a.25.25 0 0 0-.247-.212H6.608Z","clip-rule":"evenodd"})],-1)),fe=["onClick"],ke=b(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"mr-2 w-5 h-5"},[r("path",{"fill-rule":"evenodd",d:"M5 2.75C5 1.784 5.784 1 6.75 1h6.5c.966 0 1.75.784 1.75 1.75v3.552c.377.046.752.097 1.126.153A2.212 2.212 0 0 1 18 8.653v4.097A2.25 2.25 0 0 1 15.75 15h-.241l.305 1.984A1.75 1.75 0 0 1 14.084 19H5.915a1.75 1.75 0 0 1-1.73-2.016L4.492 15H4.25A2.25 2.25 0 0 1 2 12.75V8.653c0-1.082.775-2.034 1.874-2.198.374-.056.75-.107 1.127-.153L5 6.25v-3.5Zm8.5 3.397a41.533 41.533 0 0 0-7 0V2.75a.25.25 0 0 1 .25-.25h6.5a.25.25 0 0 1 .25.25v3.397ZM6.608 12.5a.25.25 0 0 0-.247.212l-.693 4.5a.25.25 0 0 0 .247.288h8.17a.25.25 0 0 0 .246-.288l-.692-4.5a.25.25 0 0 0-.247-.212H6.608Z","clip-rule":"evenodd"})],-1)),De={__name:"CargoManifestView",emits:["showLoading","showAlert","showConfirmationDlg"],setup(k,{emit:I}){const v=y("httpClient"),C=y("appconfig"),D=y("auth"),p=X().appContext;Y(),ee();const u=I,d=h(null),L=h(null),E=[{key:"id",label:"Id",sortable:!0,highlight:!0},{key:"manifest_no",label:"No",sortable:!0,highlight:!0},{key:"tgl_manifest",label:"Tgl Manifest",sortable:!0,datetime:!0},{key:"nama_kapal",label:"Kapal",sortable:!0},{key:"nama_nahkoda",label:"Nahkoda",sortable:!0},{key:"lokasi_asal",label:"Asal",sortable:!0},{key:"lokasi_tujuan",label:"Tujuan",sortable:!0},{key:"createdAt",label:"Created At",sortable:!0,datetime:!0},{key:"createdByName",label:"Created By",sortable:!0}],B={nama_kapal:{type:"string",required:!0,min:1,max:999,message:"Silahkan input nama Kapal"},nama_nahkoda:{type:"string",required:!0,min:1,max:999,message:"Silahkan input nama Nahkoda"},lokasi_asal:{type:"string",required:!0,min:1,max:999,message:"Silahkan input Asal kapal"},lokasi_tujuan:{type:"string",required:!0,min:1,max:999,message:"Silahkan input Tujuan kapal"},ticket_count:{type:"number",required:!0,message:"Silahkan input No Ticket"}},T=h([]),m=h([]),f=h(!1),g=h([{name:"Javascript",code:"js"}]);ae(()=>{q()});const O=N({get(){return D.checkPermission("ManifestDelete")}}),A=N({get(){return D.checkPermission("ManifestCreateUpdate")}}),w=async(e,a)=>{u("showLoading",!0);var t="/cargo-manifest/ticket-list?tujuan="+e;a&&(t+="&cargoManifestId="+a);var c=await v("get",t);if(u("showLoading",!1),console.log(c),c.status==200){var n=c.data.map(s=>({id:s.id,ticket_no:s.ticket_no+" a/n:"+s.nama_supir}));T.value=n}else p.config.globalProperties.showErrorDlg(c.message)},q=async()=>{u("showLoading",!0);var e=await v("get","/master/lokasi-pelabuhan");if(u("showLoading",!1),console.log(e),e.status==200){var a=e.data.map(t=>({key:t,label:t}));m.value=a}else p.config.globalProperties.showErrorDlg(e.message)},H=async(e,a,t,c,n)=>{n=n,u("showLoading",!0);var s=await v("get",`/cargo-manifest?page=${e}&pageSize=${c}&filter=${n}`);if(u("showLoading",!1),console.log(s),s.status==200)return s.data;p.config.globalProperties.showErrorDlg(s.message)},Z=()=>{var e={tgl_manifest:le.utc(),lokasi_asal:m.value[0].key,lokasi_tujuan:m.value[1].key,golongan:null,harga:0,min_length:1,max_length:1,createdAt:null,updatedAt:null};d.value.showDlg(e),g.value=[],f.value=!1,m.value.length>1&&w(e.lokasi_tujuan)},K=async e=>{u("showLoading",!0);var a=await v("get","/cargo-manifest/"+e.id);u("showLoading",!1),console.log(a),a.status==200?(w(a.data.lokasi_tujuan,a.data.id),g.value=[],a.data.ticket_count=0,a.data.detailData.forEach(t=>{g.value.push({id:t.ticket,ticket_no:t.ticketNo}),a.data.ticket_count++}),f.value=!0,d.value.showDlg(a.data)):p.config.globalProperties.showErrorDlg(a.message)},$=e=>{console.log(e)},z=async e=>{const a=new ue(B);e.ticketList=[],e.ticket_count=0,g.value.forEach(t=>{e.ticketList.push(t.id),e.ticket_count++}),a.validate(e).then(async()=>{u("showLoading",!0);var t=await v(e.id?"put":"post","/cargo-manifest",e);if(u("showLoading",!1),console.log(t),t.status==200)return d.value.currentDialogData.id=t.data.id,d.value.currentDialogData.manifest_no=t.data.manifest_no,f.value=!0,L.value.loadData(),e;p.config.globalProperties.showErrorDlg(t.message)}).catch(({errors:t,fields:c})=>{var n="";t.forEach(s=>{n+="* "+(s.message+"<br>")}),p.config.globalProperties.showErrorDlg(n)})},F=()=>{w(d.value.currentDialogData.lokasi_tujuan,null)},R=e=>{const a={name:e,code:e.substring(0,2)+Math.floor(Math.random()*1e7)};this.options.push(a),this.value.push(a)},U=(e,a)=>{d.value.currentDialogData.ticket_count=0,g.value.forEach(t=>{d.value.currentDialogData.ticket_count++})},J=e=>{window.open(C.APIBaseUrl+"/cargo-manifest/report/manifest-penumpang/"+e+"?Authorization="+D.getToken())},G=e=>{window.open(C.APIBaseUrl+"/cargo-manifest/report/"+e+"?Authorization="+D.getToken())};return(e,a)=>{const t=_("MenuTitleLabel"),c=_("DataTable"),n=_("MyInputText"),s=_("MyInputDate"),j=_("DropDown"),Q=_("InputModalDialog");return M(),x(te,null,[i(t,{label:"Cargo Manifest"}),i(c,{ref_key:"dataTable",ref:L,fields:E,loadDataFunction:H,enableDelete:O.value,enableCreate:A.value,enableUpdate:A.value,onOnCreateNew:Z,onOnEdit:K,onOnDelete:$},null,8,["enableDelete","enableCreate","enableUpdate"]),i(Q,{w:"80%",ref_key:"inputDlg",ref:d,title:"Data Cargo Manifest",onOnSubmitClick:z},{dlgContent:P(l=>[r("div",ce,[r("div",de,[i(n,{label:"Manifest No",disabled:"",value:l.currentDialogData.manifest_no,"onUpdate:value":o=>l.currentDialogData.manifest_no=o},null,8,["value","onUpdate:value"]),i(s,{label:"Tanggal Manidest",onOnChange:e.onDateChange,value:l.currentDialogData.tgl_manifest,"onUpdate:value":o=>l.currentDialogData.tgl_manifest=o},null,8,["onOnChange","value","onUpdate:value"]),i(j,{label:"Lokasi Asal",data:m.value,valueByKey:"",selectedData:l.currentDialogData.lokasi_asal,"onUpdate:selectedData":o=>l.currentDialogData.lokasi_asal=o},null,8,["data","selectedData","onUpdate:selectedData"]),i(j,{label:"Lokasi Tujuan",data:m.value,valueByKey:"",onOnChange:F,selectedData:l.currentDialogData.lokasi_tujuan,"onUpdate:selectedData":o=>l.currentDialogData.lokasi_tujuan=o},null,8,["data","selectedData","onUpdate:selectedData"]),i(n,{label:"Nama Kapal",maxlength:"200",value:l.currentDialogData.nama_kapal,"onUpdate:value":o=>l.currentDialogData.nama_kapal=o},null,8,["value","onUpdate:value"]),i(n,{label:"Nama Nahkoda",maxlength:"100",value:l.currentDialogData.nama_nahkoda,"onUpdate:value":o=>l.currentDialogData.nama_nahkoda=o},null,8,["value","onUpdate:value"]),i(n,{label:"alamat",maxlength:"200",value:l.currentDialogData.alamat,"onUpdate:value":o=>l.currentDialogData.alamat=o},null,8,["value","onUpdate:value"]),ge]),pe,r("div",me,[r("label",he,"Ticket List ("+oe(l.currentDialogData.ticket_count)+" ticket) :",1),i(ne(se),{class:"h-30",modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=o=>g.value=o),options:T.value,multiple:!0,taggable:!0,internalSearch:!1,onTag:R,onSelect:U,onRemove:U,"tag-placeholder":"Ticket List ",placeholder:"Cari No Ticket",label:"ticket_no","track-by":"id"},null,8,["modelValue","options"])])])]),additionalButton:P(l=>[f.value?(M(),x("button",{key:0,onClick:o=>G(l.currentDialogData.id),style:{height:"3em"},class:"inline-flex items-center justify-center text-white m-2 bg-yellow-600 hover:bg-yellow-700 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center"},[ve,S(" Print Manifest ")],8,_e)):V("v-if",!0),f.value?(M(),x("button",{key:1,onClick:o=>J(l.currentDialogData.id),style:{height:"3em"},class:"inline-flex items-center justify-center text-white m-2 bg-yellow-600 hover:bg-yellow-700 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-2.5 text-center"},[ke,S(" Print Manifest Penumpang ")],8,fe)):V("v-if",!0)]),_:1},512)],64)}}},ye=W(De,[["__scopeId","data-v-b34e0732"],["__file","D:/sourcecode/my_api/bnr_app_ui/src/views/CargoManifestView.vue"]]);export{ye as default};
//# sourceMappingURL=CargoManifestView-72f82113.js.map
