{"version":3,"file":"MasterGolonganPlatView-02f3eb16.js","sources":["../../src/views/MasterGolonganPlatView.vue"],"sourcesContent":["<script setup>\r\n    import { ref, onMounted, inject, getCurrentInstance, computed } from 'vue'\r\n    import { useRoute,useRouter  } from 'vue-router'\r\n    import Schema from 'async-validator';\r\n\r\n    const httpClient = inject('httpClient');\r\n    const auth = inject('auth');\r\n    const app = getCurrentInstance().appContext;\r\n\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n    const emit = defineEmits(['showLoading','showAlert','showConfirmationDlg'])\r\n\r\n    const inputDlg = ref(null);\r\n    const dataTable = ref(null);\r\n    const golonganSelection = ref([]);\r\n\r\n    const fields = [\r\n        { key: \"id\", label: \"Id\", sortable: true, highlight: true },\r\n        { key: \"golongan_name\", label: \"Golongan\", sortable: true, highlight: true },\r\n        { key: \"plat_no\", label: \"Plat No\", sortable: true,},\r\n        { key: \"createdAt\", label: \"CREATED AT\", sortable: true, datetime: true },\r\n        { key: \"updatedAt\", label: \"UPDATED AT\", sortable: true, datetime: true }\r\n    ];\r\n\r\n    \r\n    const dataValidatorDesc = {\r\n        golonganid : {type: 'number', required: true, message:\"Silahkan input golongan\"},\r\n        plat_no: {type: 'string', required: true, pattern: \"^[a-zA-Z]{1,2} [0-9]{1,4} [a-zA-Z]{1,3}$\", message:\"Silahkan input no Plat yg benar\"}\r\n    };\r\n    \r\n    onMounted(() => {\r\n        loadGolongan();\r\n    })\r\n    \r\n    const loadGolongan = async () => {\r\n        emit(\"showLoading\", true);\r\n        var response = await httpClient(\"get\", `/golongan?page=1&pageSize=1000`);\r\n        emit(\"showLoading\", false);\r\n        \r\n        console.log(response);\r\n        if (response.status == 200) {\r\n            var s = response.data.map(e=> {\r\n            return {\r\n                key: e.id,\r\n                label: e.golongan\r\n            }});\r\n            golonganSelection.value =  s;\r\n        }\r\n        else {\r\n            app.config.globalProperties.showErrorDlg(response.message);\r\n        }\r\n    }\r\n\r\n    const loadItems = async (page, sortBy, sortDesc, limit, search) => {\r\n        search = search;        \r\n        emit(\"showLoading\", true);\r\n        var response = await httpClient(\"get\", `/golongan-plat?page=${page}&pageSize=${limit}&filter=${search}`);\r\n        emit(\"showLoading\", false);\r\n        \r\n        console.log(response);\r\n        if (response.status == 200) {\r\n            return response.data;\r\n        }\r\n        else {\r\n            app.config.globalProperties.showErrorDlg(response.message);\r\n        }\r\n    }\r\n\r\n    const onCreateNew = () => {\r\n        inputDlg.value.showDlg({\r\n            golongan: null,\r\n            harga: 0,\r\n            min_length: 1,\r\n            max_length: 1,\r\n            createdAt: null,\r\n            updatedAt:null\r\n        });\r\n    }\r\n\r\n    const onEdit = (data) => {\r\n        inputDlg.value.showDlg(data);\r\n    }\r\n\r\n    const onDelete = (data) => {\r\n        console.log(data);\r\n    }\r\n    \r\n    const submit =async (submitdata) => {\r\n        emit(\"showLoading\", true);\r\n\r\n        if(!submitdata.id && submitdata.data){\r\n            var response = await httpClient(\"post\", '/golongan-plat/bulk',submitdata);\r\n            if (response && response.status == 200) {               \r\n                inputDlg.value.hide();\r\n                dataTable.value.loadData();\r\n\r\n                app.config.globalProperties.showErrorDlg(response.data.message);\r\n                return data;\r\n            }\r\n            else {\r\n                app.config.globalProperties.showErrorDlg(response.message);\r\n            }\r\n        }else {\r\n            const validator = new Schema(dataValidatorDesc);\r\n\r\n            validator.validate(submitdata).then(async () => {\r\n                var response = await httpClient(submitdata.id?\"put\":\"post\", '/golongan-plat',submitdata);\r\n                if (response && response.status == 200) {\r\n                    inputDlg.value.hide();\r\n                    dataTable.value.loadData();\r\n                    return data;\r\n                }\r\n                else {\r\n                    app.config.globalProperties.showErrorDlg(response.message);\r\n                }\r\n            }).catch(({ errors, fields }) => {\r\n                var totalMsg = \"\";\r\n                errors.forEach(e=> {                \r\n                    totalMsg += \"* \" + (e.message + \"<br>\");\r\n                }); \r\n                app.config.globalProperties.showErrorDlg(totalMsg);\r\n            });\r\n        }\r\n        emit(\"showLoading\", false);\r\n    }\r\n\r\n    const haveManagePermission = computed({\r\n        get(){\r\n            return auth.checkPermission(\"MasterPlatManage\");\r\n        } \r\n    })\r\n</script>\r\n\r\n<template>\r\n    <MenuTitleLabel label=\"Master Golongan Plat\"></MenuTitleLabel>\r\n\r\n    <DataTable  ref=\"dataTable\"\r\n                v-bind:fields=\"fields\"\r\n                :loadDataFunction=\"loadItems\"\r\n                :enableDelete=\"haveManagePermission\"\r\n                :enableCreate=\"haveManagePermission\"\r\n                :enableUpdate=\"haveManagePermission\"\r\n                @onCreateNew=\"onCreateNew\" \r\n                @onEdit=\"onEdit\" \r\n                @onDelete=\"onDelete\">\r\n    </DataTable>\r\n\r\n    <InputModalDialog  ref=\"inputDlg\" title=\"Data Golongan Plat\"  v-model:data=\"currentData\" \r\n        @onSubmitClick=\"submit\"\r\n        :enableSubmit=\"haveManagePermission\">\r\n        <template #dlgContent=\"dlgContent\">\r\n            <div class=\"flex flex-row\">\r\n                <DropDown label=\"Golongan\"  :data=\"golonganSelection\" valueByKey\r\n                v-model:selectedData=\"dlgContent.currentDialogData.golonganid\"></DropDown>\r\n                <div class=\"p-2\"></div>\r\n                <div class=\"flex flex-row items-end\">\r\n                    <MyInputText label=\"Plat No\" w=\"140px\" maxlength=11 \r\n                        inputAdditionalClass=\"uppercase\" v-model:value=\"dlgContent.currentDialogData.plat_no\" />\r\n                    <label class=\" text-xs text-white italic mb-2 ml-2\">Format -> BK 1234 SS, B 12 S,....</label>\r\n\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"mt-5\"></div>\r\n\r\n            <MyInputTextArea label=\"Data Upload Bulk\" \r\n                inputAdditionalClass=\"uppercase\" \r\n                v-model:value=\"dlgContent.currentDialogData.data\" />   \r\n            <label class=\" text-s text-white italic\">Untuk upload bulk, masukan format data dengan contoh \"B 1223 HB;A\" dimana A adalah  golongannya</label>\r\n        </template> \r\n    </InputModalDialog>    \r\n    \r\n</template>"],"names":["httpClient","inject","auth","app","getCurrentInstance","useRoute","useRouter","emit","__emit","inputDlg","ref","dataTable","golonganSelection","fields","dataValidatorDesc","onMounted","loadGolongan","response","s","e","loadItems","page","sortBy","sortDesc","limit","search","onCreateNew","onEdit","data","onDelete","submit","submitdata","Schema","errors","totalMsg","haveManagePermission","computed"],"mappings":"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"}