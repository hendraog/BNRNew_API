import{_ as T,i as f,g as I,u as P,a as C,r as v,o as N,j as x,k as d,c as B,l as n,m as O,F as V,f as F}from"./index-71bc4530.js";import{C as h}from"./index-c954885c.js";const $={__name:"MasterUserView",emits:["showLoading","showAlert","showConfirmationDlg"],setup(j,{emit:_}){const c=f("httpClient"),y=f("auth"),i=I().appContext;P(),C();const t=_,p=v(null),w=v(null),b=v([]),U=v(["Active","InActive"]),A=[{key:"id",label:"Id",sortable:!0,highlight:!0},{key:"userName",label:"User Name",sortable:!0,highlight:!0},{key:"role",label:"Role",sortable:!0},{key:"activeStatus",label:"Active",sortable:!0},{key:"createdAt",label:"CREATED AT",sortable:!0,datetime:!0},{key:"updatedAt",label:"UPDATED AT",sortable:!0,datetime:!0}],S=async(e,a,l,m,u)=>{u=u,t("showLoading",!0);var o=await c("get",`/user?page=${e}&pageSize=${m}&filter=${u}`);if(t("showLoading",!1),console.log(o),o.status==200)return o.data.forEach(D=>{D.activeStatus=D.active?"Active":"InActive"}),o.data;i.config.globalProperties.showErrorDlg(o.message)},k=async()=>{t("showLoading",!0);var e=await c("get","/master/role");if(t("showLoading",!1),console.log(e),e.status==200){var a=e.data.map(l=>({key:l,label:l}));b.value=a}else i.config.globalProperties.showErrorDlg(e.message)};N(()=>{k()});const M=()=>{p.value.showDlg({userName:null,role:"",password:"",passwordRaw:"",activeStatus:"Active"})},E=async e=>{t("showLoading",!0);var a=await c("get","/user/"+e.id);t("showLoading",!1),console.log(a),a.status==200?(a.data.password="",a.data.passwordRaw="",a.data.activeStatus=a.data.active?"Active":"InActive",p.value.showDlg(a.data)):i.config.globalProperties.showErrorDlg(a.message)},L=async e=>{t("showLoading",!0);var a=await c("delete","/user/"+e.id);t("showLoading",!1),console.log(a),a.status==200?(i.config.globalProperties.showErrorDlg("Data Deleted"),w.value.loadData()):i.config.globalProperties.showErrorDlg(a.message)},R=async e=>{if(t("showLoading",!0),e.activeStatus=="Active"?e.active=!0:e.active=!1,e.passwordRaw&&e.passwordRaw.trim()){const l=h.SHA256(e.passwordRaw);e.password=l.toString(h.enc.Hex)}var a=await c(e.id?"put":"post","/user",e);if(t("showLoading",!1),console.log(a),a.status==200)return p.value.hide(),w.value.loadData(),e;i.config.globalProperties.showErrorDlg(a.message)},g=x({get(){return y.checkPermission("MasterGolonganManage")}});return(e,a)=>{const l=d("MenuTitleLabel"),m=d("DataTable"),u=d("MyInputText"),o=d("DropDown"),D=d("InputModalDialog");return F(),B(V,null,[n(l,{label:"Master User"}),n(m,{ref_key:"dataTable",ref:w,fields:A,loadDataFunction:S,enableDelete:g.value,enableCreate:g.value,enableUpdate:g.value,onOnCreateNew:M,onOnEdit:E,onOnDelete:L},null,8,["enableDelete","enableCreate","enableUpdate"]),n(D,{ref_key:"inputDlg",ref:p,title:"Data User",data:e.currentData,"onUpdate:data":a[0]||(a[0]=s=>e.currentData=s),onOnSubmitClick:R,enableSubmit:g.value},{dlgContent:O(s=>[n(u,{label:"User Name",value:s.currentDialogData.userName,"onUpdate:value":r=>s.currentDialogData.userName=r},null,8,["value","onUpdate:value"]),n(u,{label:"Password",value:s.currentDialogData.passwordRaw,"onUpdate:value":r=>s.currentDialogData.passwordRaw=r},null,8,["value","onUpdate:value"]),n(o,{label:"Role",data:b.value,valueByKey:"",selectedData:s.currentDialogData.role,"onUpdate:selectedData":r=>s.currentDialogData.role=r},null,8,["data","selectedData","onUpdate:selectedData"]),n(o,{label:"Active",data:U.value,selectedData:s.currentDialogData.activeStatus,"onUpdate:selectedData":r=>s.currentDialogData.activeStatus=r},null,8,["data","selectedData","onUpdate:selectedData"])]),_:1},8,["data","enableSubmit"])],64)}}},G=T($,[["__file","D:/sourcecode/my_api/bnr_app_ui/src/views/MasterUserView.vue"]]);export{G as default};
//# sourceMappingURL=MasterUserView-3503f935.js.map
